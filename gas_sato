function onOpen() {
  let spreadsheet = SpreadsheetApp.getActive();
  var menuItems = [
    {name: 'リストにメール送信', functionName: 'sendMail'}
  ];
  spreadsheet.addMenu('メール送信', menuItems);
}

var today = new Date(); //日付を取得
var year = today.getFullYear(); //年
var month = today.getMonth()+1; //月、-1なのはなんで?????
var date = today.getDate(); //日付、getDay()は曜日
//var tomorrow = today.getDate()+1;
/*
function createTrigger(){
 scriptApp.newTrigger("TriggerFunction")
  .timeBased()
  .atHour(9)//9時に実行
  .everyDays(1)//1日おきに実行
  .create();
}セルから送信時間を取得するのはどうやるのーーー
*/

function sendMail(){
 /*var doc = DocumentApp.openById('1fZTLeMncFoXIpdgEBhA2FS5ROboQR9VJ_xrckpcFRW0');
 var text = doc.getBody().getText();
 var subject = doc.getName();
 */
 var sheet = SpreadsheetApp.getActive();
 var range = sheet.getDataRange();
 var rangeValues = range.getValues();
 
 for(var i = 1; i<rangeValues.length; i++){
   var time = rangeValues[i][1];
   var name = rangeValues[i][2];
   var email = rangeValues[i][3];
   var docURL = rangeValues[i][4];
   var docid = docURL.split('/')[5]; //URLからドキュメントIDを取得
   var doc = DocumentApp.openById(docid); //Googleドキュメントを取得
   var text = doc.getBody().getText().replace('{氏名}', name); //ドキュメント内の置き換え
   var subject = doc.getName(); //ドキュメント名を取得し、subjectに代入

   //var replacedText = text.replace('{氏名}', name);

   var options={
     "cc": "ishii-sato@webrage.jp",
     "bcc": "ishii-sato@webrage.jp"
   };
  
    MailApp.sendEmail(email, subject, text, options);
 }
 Browser.msgBox('メール送信が完了しました'); 
}